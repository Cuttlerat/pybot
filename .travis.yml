language: python

dist: trusty


jobs:
  include:
    - stage: build docker image
      script:
      - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
      - docker build -t yoba .
      - docker images
      - docker tag travis-ci-build-stages-demo "$DOCKER_USERNAME/yoba:${GIT_TAG:=latest}"
    - stage: push
      - docker push "$DOCKER_USERNAME/yoba:${GIT_TAG:=latest}"
